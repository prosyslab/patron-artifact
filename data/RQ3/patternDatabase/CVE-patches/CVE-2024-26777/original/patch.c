#include <stdio.h>
#include <stdint.h>
#define EINVAL 22

struct fb_var_screeninfo {
  int pixclock;
};

FILE *fp;
int current_pixclock;
struct fb_var_screeninfo *var;

void get_current_pixclock() {
  fread(&current_pixclock, sizeof(int), 1, fp);
}

void get_var_screeninfo(struct fb_var_screeninfo *var) {
  fread(&var->pixclock, sizeof(int), 1, fp);
}

static int
sisfb_check_var(struct fb_var_screeninfo *var)
{

	int pixclock;
  int drate;
	if (!var->pixclock)
		return -EINVAL;
	pixclock = var->pixclock;

  get_current_pixclock();

  if(current_pixclock == pixclock) {
		/* x=x & y=y & c=c -> assume depth change */
		drate = 1000000000 / pixclock;
	}
	return 0;
}

int main(int argc, char **argv) {
  fp = fopen("file1.txt", "r");
  var = (struct fb_var_screeninfo *)malloc(sizeof(struct fb_var_screeninfo));
  get_var_screeninfo(var);
  sisfb_check_var(var);

  return 0;
}