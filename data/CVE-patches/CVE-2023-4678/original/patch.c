#include <stdio.h>
#include <stdint.h>

struct SWFReader
{
	/*file header*/
	int length;
	char *mem;
	int frame_rate;
	int frame_count;
  int current_frame;
};

typedef struct SWFReader SWFReader;

static int swf_get_int(SWFReader *read)
{
  FILE *f = fopen("file1", "r");
  int val = 0;
  fread(&val, 4, 1, f);
  return val;
}

static int gf_bs_read_int(SWFReader *read)
{
  FILE *f = fopen("file2", "r");
  int val = 0;
  fread(&val, 4, 1, f);
  return val;
}

int gf_swf_read_header(SWFReader *read)
{
	int sig[3];
	/*get signature*/
	sig[0] = gf_bs_read_int(read);
	sig[1] = gf_bs_read_int(read);
	sig[2] = gf_bs_read_int(read);
	/*"FWS" or "CWS"*/
	if ( ((sig[0] != 'F') && (sig[0] != 'C')) || (sig[1] != 'W') || (sig[2] != 'S') ) {
		return -1;
	}

	read->frame_rate = swf_get_int(read)>>8;
	read->frame_count = swf_get_int(read);
  read->current_frame = swf_get_int(read);

	if (!read->frame_rate) read->frame_rate = 1;
	return 1;
}

static int swf_def_sound(SWFReader *read)
{

	int format = swf_get_int(read);
  int frame_delay_ms = 0;
	switch (format) {
	  /*MP3*/
    case 2:
    {
      frame_delay_ms = read->current_frame*1000;
      frame_delay_ms /= read->frame_rate; // sink
    }
	}
	return 1;
}

int main(int argc, char **argv) {
  SWFReader read;
  gf_swf_read_header(&read);
  swf_def_sound(&read);
  return 0;
}