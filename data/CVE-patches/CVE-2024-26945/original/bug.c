#include <stdio.h>
#include <stdint.h>

/*
 * Rebalance the wq table so that given a cpu, it's easy to find the
 * closest IAA instance.  The idea is to try to choose the most
 * appropriate IAA instance for a caller and spread available
 * workqueues around to clients.
 */
static void rebalance_wq_table(void) {
	int nr_nodes, nr_cpus_per_node, cpu, iaa, nr_iaa = -1;
  int cpus_per_iaa, mod_tmp;
  FILE *fp;
  
  // simplified source
  fp = fopen("linux.c", "r");
  fscanf(fp, "%d", &cpu);
  fscanf(fp, "%d", &nr_iaa);
  fscanf(fp, "%d", &nr_nodes);
  fscanf(fp, "%d", &nr_cpus_per_node);

	if (nr_iaa == 0)
		return;
  cpus_per_iaa = (nr_nodes * nr_cpus_per_node) / nr_iaa;

  mod_tmp = cpu % cpus_per_iaa; // for better analysis
  if (mod_tmp == 0) // sink
    iaa++;

}

int main(int argc, char **argv) {
  rebalance_wq_table();
  return 0;
}